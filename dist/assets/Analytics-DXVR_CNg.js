import{_ as x}from"./pdf-DU8byqIM.js";import{r as m,j as e,B as g,L as b,C as A,a as j,b as v,P as E,c as M,d as S,p as _,e as C}from"./charts-FoNSDMOs.js";import{c as R}from"./UserDashboard-DeyfgIJe.js";import"./react-BzrpNAyj.js";import"./index-BMC4Z6Sv.js";import"./icons-CvT1UHUk.js";import"./BrandIcon-CHAwuYok.js";import"./api-DtIH5hBN.js";import"./NotificationToast-Dh543eVQ.js";import"./ProfileSettings-DcfYZjNc.js";import"./useNotificationSound-Cx2IYJLs.js";/* empty css                      */import"./motion-B__JDtHc.js";import"./index-pk8n74D1.js";A.register(j,v,E,M,S,_,C);function q({token:n,refreshSignal:c}){const[i,r]=m.useState(Array(12).fill(0)),[t,a]=m.useState(Array(12).fill(0));m.useEffect(()=>{let o=!0;return R.listMine(n).then(y=>{if(!o)return;const d=Array(12).fill(0),p=Array(12).fill(0);y.complaints.forEach(l=>{const h=new Date(l.createdAt||Date.now()).getMonth();d[h]++,l.status==="Solved"&&p[h]++}),r(d);const f=d.map((l,u)=>l?Math.round(p[u]/l*100):0);a(f)}).catch(()=>{}),()=>{o=!1}},[n,c]);const s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return e.jsxs("div",{className:"panel",children:[e.jsx("h3",{children:"Analytics"}),e.jsxs("div",{className:"grid two",children:[e.jsx("div",{children:e.jsx(g,{data:{labels:s,datasets:[{label:"Complaints (Monthly)",data:i,backgroundColor:"rgba(14,165,233,0.5)"}]},options:{plugins:{legend:{display:!1}}}})}),e.jsx("div",{children:e.jsx(b,{data:{labels:s,datasets:[{label:"Resolution Rate (%)",data:t,borderColor:"#34d399",backgroundColor:"rgba(34,197,94,0.2)"}]},options:{scales:{y:{min:0,max:100}}}})})]}),e.jsx("div",{style:{marginTop:12},children:e.jsx("button",{className:"btn ghost",onClick:()=>D(s,i,t),children:"Download Analytics PDF"})})]})}function D(n,c,i){x(async()=>{const{default:r}=await import("./pdf-DU8byqIM.js").then(t=>t.j);return{default:r}},[]).then(({default:r})=>{const t=new r;t.setFontSize(16),t.text("Analytics Summary",14,20),t.setFontSize(12);let a=30;t.text("Monthly Complaints:",14,a),a+=8,n.forEach((s,o)=>{t.text(`${s}: ${c[o]}`,18,a),a+=6}),a+=6,t.text("Resolution Rate (%):",14,a),a+=8,n.forEach((s,o)=>{t.text(`${s}: ${i[o]}%`,18,a),a+=6}),t.save("analytics-summary.pdf")})}export{q as default};
