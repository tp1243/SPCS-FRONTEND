const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/PoliceOverview-DU4pHUFn.js","assets/charts-FoNSDMOs.js","assets/react-BzrpNAyj.js","assets/pdf-DU8byqIM.js","assets/index-BMC4Z6Sv.js","assets/icons-CvT1UHUk.js","assets/BrandIcon-CHAwuYok.js","assets/api-_K8V4R3t.js","assets/NotificationToast-vdJ0o7ky.js","assets/index-CtVXpgqv.js","assets/index-ByxMuA5S.css","assets/PoliceComplaints-c8WANCTH.js","assets/useNotificationSound-Cx2IYJLs.js","assets/PoliceMap-V_3Wqnq-.js","assets/PoliceReports-CdZk_ugN.js","assets/PoliceChat-Dyzih8sg.js","assets/PoliceAlerts-CO6y_UtG.js","assets/PoliceOfficers-Bdua6qkF.js","assets/PoliceSettings-Cbhi0zc7.js","assets/PoliceSettings-BOV-m-_t.css","assets/PoliceNotifications-CORvYThQ.js","assets/notifications-DP_hiXwD.css"])))=>i.map(i=>d[i]);
import{_ as u}from"./pdf-DU8byqIM.js";import{r as a,j as e}from"./charts-FoNSDMOs.js";import{d as w,F as L,a as F,f as P,e as R,g as D,y as U,i as V,h as G,z as J,A as q,B as M,m as H}from"./index-BMC4Z6Sv.js";import{B as Q}from"./BrandIcon-CHAwuYok.js";import{r as o}from"./api-_K8V4R3t.js";import{c as W,N as K}from"./NotificationToast-vdJ0o7ky.js";import{u as X}from"./index-CtVXpgqv.js";const _={async listComplaints(t,s){const r=new URLSearchParams;s?.status&&r.set("status",s.status),s?.page&&r.set("page",String(s.page)),s?.limit&&r.set("limit",String(s.limit)),s?.fields&&r.set("fields",s.fields);const l=r.toString()?`?${r.toString()}`:"";return o(`/police/complaints${l}`,{method:"GET",headers:{Authorization:`Bearer ${t}`}})},async assignComplaint(t,s){return o(`/police/complaints/${s}/assign`,{method:"POST",headers:{Authorization:`Bearer ${t}`}})},async updateComplaintStatus(t,s,r){return o(`/police/complaints/${s}/status`,{method:"PUT",headers:{Authorization:`Bearer ${t}`},body:JSON.stringify({status:r})})},async getComplaintById(t,s){return o(`/police/complaints/${s}`,{method:"GET",headers:{Authorization:`Bearer ${t}`}})},async listAlerts(t){return o("/police/alerts",{method:"GET",headers:{Authorization:`Bearer ${t}`}})},async handleAlert(t,s){return o(`/police/alerts/${s}/handle`,{method:"PUT",headers:{Authorization:`Bearer ${t}`}})},async listOfficers(t){return o("/police/officers",{method:"GET",headers:{Authorization:`Bearer ${t}`}})},async profile(t){return o("/police/profile",{method:"GET",headers:{Authorization:`Bearer ${t}`}})},async updateProfile(t,s){return o("/police/profile",{method:"PUT",headers:{Authorization:`Bearer ${t}`},body:JSON.stringify(s)})},async listChats(t){return o("/police/chat/messages",{method:"GET",headers:{Authorization:`Bearer ${t}`}})},async sendChat(t,s){return o("/police/chat/send",{method:"POST",headers:{Authorization:`Bearer ${t}`},body:JSON.stringify(s)})},async listNotifications(t){return o("/police/notifications",{method:"GET",headers:{Authorization:`Bearer ${t}`}})},async markNotificationRead(t,s){return o(`/police/notifications/${s}/read`,{method:"PUT",headers:{Authorization:`Bearer ${t}`}})},async markAllNotificationsRead(t){return o("/police/notifications/read-all",{method:"PUT",headers:{Authorization:`Bearer ${t}`}})},async listStations(t){return o("/police/stations",{method:"GET",headers:{Authorization:`Bearer ${t}`}})},async bulkStations(t,s){return o("/police/stations/bulk",{method:"POST",headers:{Authorization:`Bearer ${t}`},body:JSON.stringify(s)})},async changePassword(t,s,r){return o("/police/auth/change-password",{method:"POST",headers:{Authorization:`Bearer ${t}`},body:JSON.stringify({currentPassword:s,newPassword:r})})},async logoutAll(t){return o("/police/logout-all",{method:"POST",headers:{Authorization:`Bearer ${t}`}})},async enable2FA(t,s){return o("/police/auth/2fa/enable",{method:"POST",headers:{Authorization:`Bearer ${t}`},body:JSON.stringify({enable:s})})},async requestStationUpdate(t,s){return o("/police/stations/request-update",{method:"POST",headers:{Authorization:`Bearer ${t}`},body:JSON.stringify(s)})},async stats(t){return o("/police/stats",{method:"GET",headers:{Authorization:`Bearer ${t}`}})}};function Y({token:t,username:s,onSearch:r,onLogout:l}){const[f,g]=a.useState(""),[x,n]=a.useState(!1),[j,v]=a.useState(!1),[p,h]=a.useState([]),[d,T]=a.useState(()=>localStorage.getItem("theme")||"dark"),[S,I]=a.useState(()=>localStorage.getItem("lang")||"en"),[A,z]=a.useState(()=>localStorage.getItem("sound")==="on"),[y,b]=a.useState(null);a.useEffect(()=>{let i=!0;const N={value:""};_.listNotifications(t).then(c=>{if(!i)return;h(c.notifications);const m=c.notifications[0]?.createdAt||"";N.value=m}).catch(()=>{});const $=setInterval(()=>{_.listNotifications(t).then(c=>{h(c.notifications);const m=c.notifications[0]?.createdAt||"";if(m&&m!==N.value){N.value=m;const B=c.notifications[0]?.message||"New complaint raised";b({message:B,type:"info"})}}).catch(()=>{})},8e3),E=W("police",t);return E.on("police:new_complaint",c=>{b({message:c.message,type:"info"}),h(m=>[{_id:String(Date.now()),message:c.message,read:!1,createdAt:c.createdAt||new Date().toISOString(),complaintId:c.complaintId||void 0,station:""},...m])}),()=>{i=!1,clearInterval($),E.disconnect()}},[t]),a.useEffect(()=>{d==="light"?document.body.classList.add("light-theme"):document.body.classList.remove("light-theme"),localStorage.setItem("theme",d)},[d]),a.useEffect(()=>{localStorage.setItem("lang",S)},[S]);const C=p.filter(i=>!i.read).length;return e.jsxs("header",{className:"dash-navbar",children:[e.jsx("div",{className:"dash-left",children:e.jsxs("div",{className:"logo","aria-label":"Smart Police Complaint System (SPCS)",children:[e.jsx(Q,{height:24,className:"logo-icon",title:"SPCS logo"}),e.jsx("span",{className:"logo-text",children:"CIVICSHIELD"})]})}),e.jsx("div",{className:"dash-center",children:e.jsxs("div",{className:"search",children:[e.jsx(w,{}),e.jsx("input",{value:f,onChange:i=>g(i.target.value),placeholder:"Search by title, ID, status"}),e.jsx("button",{className:"btn sm",onClick:()=>r(f),children:"Search"})]})}),e.jsxs("div",{className:"dash-right",children:[e.jsxs("div",{className:"welcome",children:["Welcome, ",s,"!"]}),e.jsx("button",{className:"btn toggle",onClick:()=>T(i=>i==="dark"?"light":"dark"),children:d==="dark"?e.jsx(L,{}):e.jsx(F,{})}),e.jsxs("select",{value:S,onChange:i=>I(i.target.value),className:"btn toggle",style:{background:"transparent",color:"var(--text)",borderColor:"#24324a"},children:[e.jsx("option",{value:"en",children:"EN"}),e.jsx("option",{value:"hi",children:"HI"}),e.jsx("option",{value:"mr",children:"MR"})]}),e.jsx("button",{className:"btn toggle",onClick:()=>{const i=!A;z(i),localStorage.setItem("sound",i?"on":"off"),window.dispatchEvent(new Event(i?"spcs:enable-sound":"spcs:disable-sound"))},title:A?"Disable sound":"Enable sound",children:e.jsx(P,{})}),e.jsx("div",{className:"avatar",onClick:()=>n(i=>!i),children:e.jsx(R,{})}),e.jsxs("div",{className:"bell",onClick:()=>v(i=>!i),children:[e.jsx(P,{}),C>0&&e.jsx("span",{className:"badge",children:C})]}),x&&e.jsxs("div",{className:"dropdown",children:[e.jsx("button",{onClick:()=>n(!1),children:"View Profile"}),e.jsx("button",{onClick:()=>n(!1),children:"Edit Profile"}),e.jsx("button",{onClick:()=>n(!1),children:"Settings"}),e.jsx("button",{onClick:l,children:"Logout"})]}),j&&e.jsxs("div",{className:"dropdown wide",children:[p.length===0?e.jsx("div",{className:"muted",children:"No updates"}):p.map(i=>e.jsxs("div",{className:`notif ${i.read?"":"unread"}`,children:[e.jsx("div",{children:i.message}),e.jsx("small",{children:new Date(i.createdAt||"").toLocaleString()})]},i._id)),e.jsx("div",{className:"actions",children:e.jsx("button",{className:"btn ghost",onClick:async()=>{const i=await _.markAllNotificationsRead(t);h(i.notifications)},children:"Clear All"})})]}),y&&e.jsx(K,{message:y.message,type:y.type,onClose:()=>b(null)})]})]})}const Z=[{key:"overview",label:"Dashboard Overview",icon:D},{key:"active",label:"Active Complaints",icon:U},{key:"pending",label:"Pending Complaints",icon:V},{key:"fir",label:"FIR Complaints",icon:G},{key:"non-fir",label:"Non-FIR Complaints",icon:J},{key:"completed",label:"Completed Cases",icon:q},{key:"notifications",label:"Notifications / Updates",icon:P},{key:"settings",label:"Settings & Profile",icon:M}];function ee({active:t,onChange:s,onLogout:r}){return e.jsxs("aside",{className:"dash-sidebar",children:[e.jsx("nav",{children:Z.map(l=>{const f=l.icon;return e.jsxs("button",{className:`side-item ${t===l.key?"active":""}`,onClick:()=>s(l.key),children:[e.jsx(f,{}),e.jsx("span",{children:l.label})]},l.key)})}),e.jsx("div",{className:"side-footer",children:e.jsxs("button",{className:"side-item",onClick:r,children:[e.jsx(H,{}),e.jsx("span",{children:"Logout"})]})})]})}const O=a.lazy(()=>u(()=>import("./PoliceOverview-DU4pHUFn.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),k=a.lazy(()=>u(()=>import("./PoliceComplaints-c8WANCTH.js"),__vite__mapDeps([11,1,2,4,5,12,3,6,7,8,9,10]))),te=a.lazy(()=>u(()=>import("./PoliceMap-V_3Wqnq-.js"),__vite__mapDeps([13,1,2,3,4,5,6,7,8,9,10]))),se=a.lazy(()=>u(()=>import("./PoliceReports-CdZk_ugN.js"),__vite__mapDeps([14,3,1,2,4,5,6,7,8,9,10]))),ae=a.lazy(()=>u(()=>import("./PoliceChat-Dyzih8sg.js"),__vite__mapDeps([15,1,2,3,4,5,6,7,8,9,10]))),ie=a.lazy(()=>u(()=>import("./PoliceAlerts-CO6y_UtG.js"),__vite__mapDeps([16,1,2,3,4,5,6,7,8,9,10]))),oe=a.lazy(()=>u(()=>import("./PoliceOfficers-Bdua6qkF.js"),__vite__mapDeps([17,1,2,3,4,5,6,7,8,9,10]))),ne=a.lazy(()=>u(()=>import("./PoliceSettings-Cbhi0zc7.js"),__vite__mapDeps([18,1,2,3,4,5,6,7,8,9,10,19]))),re=a.lazy(()=>u(()=>import("./PoliceNotifications-CORvYThQ.js"),__vite__mapDeps([20,1,2,4,5,8,12,3,6,7,9,10,21])));function le(){const t=X(),[s,r]=a.useState("overview"),[l,f]=a.useState(null);a.useEffect(()=>{const p=localStorage.getItem("policeToken"),h=localStorage.getItem("policeUser");if(!p||!h){t("/police/login");return}try{const d=JSON.parse(h);f({id:d.id,username:d.username,station:d.station,email:d.email})}catch{t("/police/login")}},[]);function g(){localStorage.removeItem("policeToken"),localStorage.removeItem("policeUser"),t("/police/login")}const x=l?.username||"Officer",n=localStorage.getItem("policeToken")||"",j=a.useMemo(()=>{switch(s){case"overview":return e.jsxs(a.Suspense,{fallback:e.jsx("div",{}),children:[" ",e.jsx(O,{token:n,station:l?.station})," "]});case"active":case"pending":case"completed":return e.jsxs(a.Suspense,{fallback:e.jsx("div",{}),children:[" ",e.jsx(k,{token:n,filter:s,officer:l||void 0})," "]});case"fir":return e.jsxs(a.Suspense,{fallback:e.jsx("div",{}),children:[" ",e.jsx(k,{token:n,categoryFilter:"fir",officer:l||void 0})," "]});case"non-fir":return e.jsxs(a.Suspense,{fallback:e.jsx("div",{}),children:[" ",e.jsx(k,{token:n,categoryFilter:"non-fir",officer:l||void 0})," "]});case"map":return e.jsxs(a.Suspense,{fallback:e.jsx("div",{}),children:[" ",e.jsx(te,{token:n})," "]});case"analytics":return e.jsxs(a.Suspense,{fallback:e.jsx("div",{}),children:[" ",e.jsx(se,{token:n})," "]});case"chat":return e.jsxs(a.Suspense,{fallback:e.jsx("div",{}),children:[" ",e.jsx(ae,{token:n,officer:l||void 0})," "]});case"alerts":return e.jsxs(a.Suspense,{fallback:e.jsx("div",{}),children:[" ",e.jsx(ie,{token:n})," "]});case"notifications":return e.jsxs(a.Suspense,{fallback:e.jsx("div",{}),children:[" ",e.jsx(re,{token:n})," "]});case"officers":return e.jsxs(a.Suspense,{fallback:e.jsx("div",{}),children:[" ",e.jsx(oe,{token:n})," "]});case"settings":return e.jsxs(a.Suspense,{fallback:e.jsx("div",{}),children:[" ",e.jsx(ne,{token:n})," "]});case"help":return e.jsx("div",{className:"panel",children:e.jsx("div",{className:"muted",children:"For help, contact system admin or see documentation."})});default:return e.jsxs(a.Suspense,{fallback:e.jsx("div",{}),children:[" ",e.jsx(O,{token:n})," "]})}},[s,n,l]);function v(p){r("active")}return e.jsxs("div",{className:"dashboard",children:[e.jsx(Y,{token:n,username:x,onSearch:v,onLogout:g}),e.jsxs("div",{className:"dash-body",children:[e.jsx(ee,{active:s,onChange:r,onLogout:g}),e.jsx("main",{className:"dash-main",children:j})]})]})}const ge=Object.freeze(Object.defineProperty({__proto__:null,default:le},Symbol.toStringTag,{value:"Module"}));export{ge as P,_ as p};
