import{_ as f}from"./pdf-DU8byqIM.js";import{r as i,j as s,B as x,C as b,a as h,b as P,d as j,p as y,e as S}from"./charts-FoNSDMOs.js";import{p as C}from"./PoliceDashboard-B_6WCH-t.js";import"./react-BzrpNAyj.js";import"./index-BMC4Z6Sv.js";import"./icons-CvT1UHUk.js";import"./BrandIcon-CHAwuYok.js";import"./api-BjEggnHr.js";import"./NotificationToast-CycjYKEj.js";import"./index-wqQdJ3sC.js";b.register(h,P,j,y,S);function U({token:l}){const[t,c]=i.useState({pending:0,inProgress:0,solved:0}),[d,p]=i.useState(null);i.useEffect(()=>{C.listComplaints(l,{fields:"summary",limit:200}).then(r=>{const e=r.complaints.reduce((n,o)=>(n[o.status]=(n[o.status]||0)+1,n),{});c({pending:e.Pending||0,inProgress:(e["In Progress"]||0)+(e["Under Review"]||0),solved:e.Solved||0})}).catch(r=>p(r.message||"Failed to load analytics"))},[l]);const g={labels:["Pending","In Progress","Solved"],datasets:[{label:"Count",data:[t.pending,t.inProgress,t.solved],backgroundColor:["#f59e0b","#3b82f6","#10b981"]}]};function m(){const e=[["Status","Count"],["Pending",String(t.pending)],["In Progress",String(t.inProgress)],["Solved",String(t.solved)]].map(v=>v.join(",")).join(`
`),n=new Blob([e],{type:"text/csv;charset=utf-8;"}),o=URL.createObjectURL(n),a=document.createElement("a");a.href=o,a.download="report.csv",a.click(),URL.revokeObjectURL(o)}function u(){f(async()=>{const{default:r}=await import("./pdf-DU8byqIM.js").then(e=>e.j);return{default:r}},[]).then(({default:r})=>{const e=new r;e.text("Complaints Report",20,20),e.text(`Pending: ${t.pending}`,20,40),e.text(`In Progress: ${t.inProgress}`,20,50),e.text(`Solved: ${t.solved}`,20,60),e.save("report.pdf")})}return s.jsxs("div",{className:"panel",children:[s.jsx("div",{className:"label",children:"Reports & Analytics"}),d&&s.jsx("div",{className:"form-error",children:d}),s.jsx("div",{className:"card",style:{padding:12},children:s.jsx(x,{data:g,options:{plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0}}}})}),s.jsxs("div",{style:{display:"flex",gap:10,marginTop:12},children:[s.jsx("button",{className:"btn",onClick:m,children:"Export CSV"}),s.jsx("button",{className:"btn ghost",onClick:u,children:"Download PDF"})]}),s.jsx("div",{className:"muted",style:{marginTop:8},children:"AI insights will be added later, e.g., “This week, cybercrime increased by 12%”."})]})}export{U as default};
