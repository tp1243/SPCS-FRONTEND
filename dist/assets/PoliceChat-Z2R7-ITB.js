import{r as a,j as s}from"./charts-FoNSDMOs.js";import{p as d}from"./PoliceDashboard-CA_takbR.js";import"./react-BzrpNAyj.js";import"./pdf-DU8byqIM.js";import"./index-BMC4Z6Sv.js";import"./icons-CvT1UHUk.js";import"./BrandIcon-CHAwuYok.js";import"./api-Cc3zVDBP.js";import"./NotificationToast-CycjYKEj.js";import"./index-BW3I4jBn.js";function S({token:t,officer:r}){const[m,l]=a.useState([]),[i,n]=a.useState(""),[c,o]=a.useState(null);a.useEffect(()=>{d.listChats(t).then(e=>l(e.messages||[])).catch(e=>o(e.message||"Failed to load messages"))},[t]);async function p(){if(i.trim())try{const e=await d.sendChat(t,{text:i});l(x=>[...x,e.message]),n("")}catch(e){o(e.message||"Failed to send")}}return s.jsxs("div",{className:"panel",children:[s.jsx("div",{className:"label",children:"Real-Time Communication"}),c&&s.jsx("div",{className:"form-error",children:c}),s.jsxs("div",{className:"chat-box",style:{display:"flex",flexDirection:"column",gap:8,padding:12,borderRadius:8,background:"var(--panel)"},children:[s.jsx("div",{className:"messages",style:{maxHeight:360,overflow:"auto",display:"flex",flexDirection:"column",gap:6},children:m.map(e=>s.jsx("div",{className:"message",style:{alignSelf:e.from===r?.username?"flex-end":"flex-start"},children:s.jsxs("div",{className:"card sm",style:{background:e.from===r?.username?"var(--accent-700)":"var(--panel-700)"},children:[s.jsx("div",{className:"muted",style:{fontSize:11},children:e.from||"Citizen"}),s.jsx("div",{children:e.text})]})},e._id))}),s.jsxs("div",{style:{display:"flex",gap:8},children:[s.jsx("input",{value:i,onChange:e=>n(e.target.value),placeholder:"Type a message"}),s.jsx("button",{className:"btn",onClick:p,children:"Send"})]})]}),s.jsx("div",{className:"muted",style:{marginTop:8},children:"Push notifications and in-app calls can be integrated later."})]})}export{S as default};
