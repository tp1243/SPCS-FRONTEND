import{r,j as e}from"./charts-FoNSDMOs.js";import{A as F}from"./AuthShowcase-Eo01-u_1.js";import{l as O}from"./loginimg-DZn52-M4.js";import{C as D,D as I}from"./index-BMC4Z6Sv.js";import{A as L,S as R,O as $}from"./OtpModal-BBhwRDrM.js";import{m as z}from"./motion-B__JDtHc.js";import{u as U,a as H,L as v}from"./index-BW3I4jBn.js";import"./react-BzrpNAyj.js";import"./icons-CvT1UHUk.js";import"./index-D8KJrxB-.js";import"./BrandIcon-CHAwuYok.js";import"./api-Cc3zVDBP.js";import"./pdf-DU8byqIM.js";function _(){const h=U(),u=H(),[l,w]=r.useState(""),[c,y]=r.useState(""),[i,S]=r.useState(""),[d,b]=r.useState(!1),[p,g]=r.useState(""),[a,N]=r.useState(""),[x,o]=r.useState(""),[f,j]=r.useState(""),[E,m]=r.useState(!1),[P,C]=r.useState(null);r.useEffect(()=>{const s=new URLSearchParams(u.search),t=s.get("token"),n=s.get("user");if(t){if(localStorage.setItem("token",t),n)try{localStorage.setItem("user",n)}catch{}h("/user")}},[u.search]);const k=async s=>{if(s.preventDefault(),g(""),a.replace(/\D/g,"").length!==10){o("Enter valid phone no");return}if(!/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&]).{8,}$/.test(i)){j("Enter strong password with uppercase, lowercase, number and symbol");return}if(!l||!c||!i){g("Please fill in all fields");return}const A=a?a.startsWith("+")?a:`+91${a.replace(/\D/g,"").slice(-10)}`:void 0;C({username:l,password:i,phone:A}),m(!0)};return e.jsxs(e.Fragment,{children:[e.jsx(L,{variant:"register"}),e.jsxs("div",{className:"auth-layout user-auth",children:[e.jsx("div",{className:"auth-left",children:e.jsx(F,{title:"Create your account",subtitle:"Join SPCS to submit and track complaints.",imageSrc:O,imageAlt:"Register illustration"})}),e.jsx("div",{className:"auth-right",children:e.jsxs(z.form,{className:"auth-card auth-form",onSubmit:k,initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:[e.jsx("h3",{children:"Create an account"}),e.jsxs("div",{className:"auth-subtext",children:["Already have an account? ",e.jsx(v,{to:"/login",children:"Log in"})]}),e.jsxs("div",{className:"form-row",children:[e.jsx("input",{id:"register-username",type:"text",value:l,onChange:s=>w(s.target.value),placeholder:" "}),e.jsx("label",{htmlFor:"register-username",children:"Username"})]}),e.jsxs("div",{className:"form-row",children:[e.jsx("input",{id:"register-email",type:"email",value:c,onChange:s=>y(s.target.value),placeholder:" "}),e.jsx("label",{htmlFor:"register-email",children:"Email"})]}),e.jsxs("div",{className:"form-row phone-row",children:[e.jsx("div",{className:"country-prefix",children:"IND +91"}),e.jsx("input",{id:"register-phone",type:"tel",value:a,onChange:s=>{const t=s.target.value.replace(/\D/g,"");N(t),t?t.length>10?o("Enter valid phone no"):t.length<10?o("Enter 10-digit phone no"):o(""):o("")},placeholder:"Mobile number"})]}),x&&e.jsx("div",{className:"form-error",children:x}),e.jsx("div",{className:"form-row",children:e.jsxs("div",{className:"password-row",children:[e.jsx("input",{id:"register-password",type:d?"text":"password",value:i,onChange:s=>{const t=s.target.value;S(t);const n=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&]).{8,}$/.test(t);j(n?"":"Enter strong password with uppercase, lowercase, number and symbol")},placeholder:" "}),e.jsx("label",{htmlFor:"register-password",children:"Password"}),e.jsx("button",{type:"button",className:"pwd-toggle",onClick:()=>b(s=>!s),"aria-label":d?"Hide password":"Show password",children:d?e.jsx(D,{}):e.jsx(I,{})})]})}),f&&e.jsx("div",{className:"form-error",children:f}),p&&e.jsx("div",{className:"form-error",children:p}),e.jsxs("div",{className:"tc-row",children:[e.jsx("input",{id:"tc",type:"checkbox",defaultChecked:!0}),e.jsxs("label",{htmlFor:"tc",children:["I agree to the ",e.jsx("a",{href:"#terms",children:"Terms & Conditions"})]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"submit",className:"btn primary",children:"Register"}),e.jsx(v,{className:"btn ghost",to:"/login",children:"Already have an account"})]}),e.jsx(R,{})]})})]}),e.jsx($,{open:E,purpose:"register",email:c,beginPayload:P||void 0,onClose:()=>m(!1),onSuccess:s=>{try{localStorage.setItem("token",s.token),localStorage.setItem("user",JSON.stringify(s.user))}catch{}m(!1),h("/user")}})]})}export{_ as default};
